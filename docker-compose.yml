x-qdrant-config: &qdrant-config
  # Qdrant connection settings for debugging
  QDRANT_HOST: qdrant
  QDRANT_PORT: 6333
  QDRANT_GRPC_PORT: 6334
  QDRANT_API_KEY: ""  # No API key needed for local development

x-postgres-config: &postgres-config
  POSTGRES_HOST: postgres
  POSTGRES_PORT: 5432
  POSTGRES_USER: postgres
  POSTGRES_PASSWORD: postgres
  POSTGRES_DB: mcpdb

services:

  mcp_server_arxiv:
    build:
      context: ./mcp-server-arxiv
      dockerfile: Dockerfile
    image: mcp_server_arxiv
    container_name: mcp_server_arxiv
    command: ["python", "-m", "mcp_server_arxiv", "--port", "8100"]
    ports:
      - "8100:8100"
    env_file:
      - ./mcp-server-arxiv/.env
    restart: unless-stopped

  mcp_server_cartesia:
    build:
      context: ./mcp-server-cartesia
      dockerfile: Dockerfile
    image: mcp_server_cartesia
    container_name: mcp_server_cartesia
    command: ["python", "-m", "mcp_server_cartesia", "--port", "8101"]
    ports:
      - "8101:8101"
    env_file:
      - ./mcp-server-cartesia/.env
    restart: unless-stopped

  mcp_server_lurky:
    build:
      context: ./mcp-server-lurky
      dockerfile: Dockerfile
    image: mcp_server_lurky
    container_name: mcp_server_lurky
    ports:
      - "8112:8112"
    env_file:
      - ./mcp-server-lurky/.env
    environment:
      MCP_LURKY_PORT: "8112"
    restart: unless-stopped

  mcp_server_quill:
    build:
      context: ./mcp-server-quill
      dockerfile: Dockerfile
    image: mcp_server_quill
    container_name: mcp_server_quill
    command: ["python", "-m", "mcp_server_quill", "--port", "8113"]
    ports:
      - "8113:8113"
    env_file:
      - ./mcp-server-quill/.env
    restart: unless-stopped

  mcp_server_qdrant:
    build:
      context: ./mcp-server-qdrant
      dockerfile: Dockerfile
    image: mcp_server_qdrant
    container_name: mcp_server_qdrant
    command: ["python", "-m", "mcp_server_qdrant", "--port", "8104"]
    ports:
      - "8104:8104"
    env_file:
      - ./mcp-server-qdrant/.env
    depends_on:
      - qdrant
    restart: unless-stopped

  mcp_server_stability:
    build:
      context: ./mcp-server-stability
      dockerfile: Dockerfile
    image: mcp_server_stability
    container_name: mcp_server_stability
    command: ["python", "-m", "mcp_server_stable_diffusion", "--port", "8105"]
    ports:
      - "8105:8105"
    env_file:
      - ./mcp-server-stability/.env
    restart: unless-stopped

  mcp_server_tavily:
    build:
      context: ./mcp-server-tavily
      dockerfile: Dockerfile
    image: mcp_server_tavily
    container_name: mcp_server_tavily
    command: ["python", "-m", "mcp_server_tavily", "--port", "8106"]
    ports:
      - "8106:8106"
    env_file:
      - ./mcp-server-tavily/.env
    restart: unless-stopped

  mcp_server_telegram:
    build:
      context: ./mcp-server-telegram
      dockerfile: Dockerfile
    image: mcp_server_telegram
    container_name: mcp_server_telegram
    command: ["python", "-m", "mcp_server_telegram", "--port", "8107"]
    ports:
      - "8107:8107"
    env_file:
      - ./mcp-server-telegram/.env
    restart: unless-stopped

  mcp_server_together_imgen:
    build:
      context: ./mcp-server-together-imgen
      dockerfile: Dockerfile
    image: mcp_server_together_imgen
    container_name: mcp_server_together_imgen
    command: ["python", "-m", "mcp_server_together_imgen", "--port", "8108"]
    ports:
      - "8108:8108"
    env_file:
      - ./mcp-server-together-imgen/.env
    restart: unless-stopped

  mcp_server_twitter:
    build:
      context: ./mcp-server-twitter
      dockerfile: Dockerfile
    image: mcp_server_twitter
    container_name: mcp_server_twitter
    command: ["python", "-m", "mcp_server_twitter", "--port", "8109"]
    ports:
      - "8109:8109"
    env_file:
      - ./mcp-server-twitter/.env
    restart: unless-stopped

  mcp_server_weather:
    build:
      context: ./mcp-server-template
      dockerfile: Dockerfile
    image: mcp_server_weather
    container_name: mcp_server_weather
    command: ["python", "-m", "mcp_server_weather", "--port", "8110"]
    ports:
      - "8110:8110"
    env_file:
      - ./mcp-server-template/.env
    restart: unless-stopped

  mcp_server_youtube:
    build:
      context: ./mcp-server-youtube
      dockerfile: Dockerfile
    image: mcp_server_youtube
    container_name: mcp_server_youtube
    command: ["python", "-m", "mcp_server_youtube", "--port", "8111"]
    ports:
      - "8111:8111"
    env_file:
      - ./mcp-server-youtube/.env
    restart: unless-stopped

  qdrant:
    image: qdrant/qdrant:latest
    container_name: qdrant_storage
    volumes:
      - qdrant-data:/qdrant/storage
    ports:
      - "6333:6333"  # REST API
      - "6334:6334"  # gRPC
    environment:
      <<: *qdrant-config
    restart: unless-stopped

volumes:
  qdrant-data:
